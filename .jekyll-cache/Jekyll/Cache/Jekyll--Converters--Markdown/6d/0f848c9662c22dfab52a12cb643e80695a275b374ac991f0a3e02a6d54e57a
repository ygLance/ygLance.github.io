I"î,<h1 id="å¿«é€Ÿå¹‚">å¿«é€Ÿå¹‚</h1>

<p>ä¹˜æ–¹æ“ä½œååˆ†è€—æ—¶,éœ€è¦ä¸€ç§ä¹˜æ–¹çš„å¿«é€Ÿæ±‚æ³•,
ä¸€ä¸ªæ•°çš„7æ¬¡æ–¹,æ˜¾ç„¶æˆ‘ä»¬å¯ä»¥æ‹†åˆ†ä¸ºäºŒæ¬¡æ–¹ä¹˜äº”æ¬¡æ–¹,è€ŒäºŒè¿›åˆ¶ä¸­,å¯ä»¥æ›´åŠ æ–¹ä¾¿çš„æ‹†åˆ†ä¹‹â€¦
<!--more-->
<a href="https://zhuanlan.zhihu.com/p/95902286">å‚è€ƒ</a></p>

<hr />

<h2 id="é€’å½’æ±‚å¹‚">é€’å½’æ±‚å¹‚</h2>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//é€’å½’å¿«é€Ÿå¹‚,é€šè¿‡åˆ†è§£ä¸ºå¤šä¸ªéƒ¨åˆ†å†ç»„åˆ</span>
<span class="k">typedef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">ll</span><span class="p">;</span>
<span class="n">ll</span> <span class="nf">fpow</span><span class="p">(</span><span class="n">ll</span> <span class="n">a</span><span class="p">,</span> <span class="n">ll</span> <span class="n">n</span><span class="p">)</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">qpow</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">a</span> <span class="o">%</span> <span class="n">MOD</span><span class="p">;</span>
    <span class="k">else</span>
    <span class="p">{</span>
        <span class="n">ll</span> <span class="n">temp</span> <span class="o">=</span> <span class="n">qpow</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">n</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">%</span> <span class="n">MOD</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">temp</span> <span class="o">*</span> <span class="n">temp</span> <span class="o">%</span> <span class="n">MOD</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="c1">//å¦‚æœè¦å–æ¨¡,æ­¥æ­¥å–æ¨¡</span>
</code></pre></div></div>

<hr />

<h2 id="ä½è¿ç®—æ±‚å¹‚">ä½è¿ç®—æ±‚å¹‚</h2>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//éé€’å½’å¿«é€Ÿå¹‚</span>
<span class="kt">int</span> <span class="nf">fpow</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span> <span class="kt">int</span> <span class="n">n</span><span class="p">){</span>
    <span class="kt">int</span> <span class="n">ans</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="k">while</span><span class="p">(</span><span class="n">n</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">n</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span>        <span class="c1">//å¦‚æœnçš„å½“å‰æœ«ä½ä¸º1</span>
            <span class="n">ans</span> <span class="o">*=</span> <span class="n">a</span><span class="p">;</span>  <span class="c1">//ansä¹˜ä¸Šå½“å‰çš„a</span>
        <span class="n">a</span> <span class="o">*=</span> <span class="n">a</span><span class="p">;</span>        <span class="c1">//aè‡ªä¹˜</span>
        <span class="n">n</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span><span class="p">;</span>       <span class="c1">//nå¾€å³ç§»ä¸€ä½</span>
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">ans</span><span class="p">;</span>
<span class="p">}</span>

</code></pre></div></div>

<p>å…¶æ€è·¯æ˜¯,å°†$a^n$ çš„nå†™æˆäºŒè¿›åˆ¶,éå†æŒ‡æ•°,å½“æŒ‡æ•°æœ€å·¦è¾¹ä¸€ä½æ˜¯1æ—¶,å°±ä¹˜ä¸Šä¸å½“å‰ä½æ•°å¯¹åº”çš„açš„å¹‚,æ¯å¾€å·¦ä¸€ä½å°±è®©è¿™ä¸ªä¸­é—´å¹‚å–å¹³æ–¹(å› ä¸ºè¿™å®é™…ä¸Šä¹Ÿæ˜¯ä¸ªæ‹†åˆ†çš„è¿‡ç¨‹,$a^{1010}$ ==$a^{1000}*a^{10}$  äºŒè¿›åˆ¶åˆšå¥½å¯ä»¥æ‹†ä¹˜1000,100,10,1å³1,2,4,8(æ³¨æ„æ˜¯æŒ‡æ•°ç¿»å€,å³æ•°å€¼å–å¹³æ–¹)</p>

<hr />

<h2 id="å¿«é€Ÿå¹‚æ¨¡ç‰ˆ">å¿«é€Ÿå¹‚æ¨¡ç‰ˆ</h2>

<p>äºŒè¿›åˆ¶ä¸æ˜¯å°æ•°,éšä¾¿å¹‚</p>

<hr />

<h2 id="æ–æ³¢é‚£å¥‘æ•°åˆ—">æ–æ³¢é‚£å¥‘æ•°åˆ—</h2>

<p>ä¸€ä¸ªçŸ©é˜µå¿«é€Ÿå¹‚çš„ç²¾å½©ä¾‹å­</p>

<p>æ´›è°·1962,ç›´æ¥è½¬åŒ–ä¸ºå¿«é€Ÿå¹‚</p>

<p>åˆ†æ: å¯¹äº <script type="math/tex">\left[ \begin{matrix} X\\ Y \end{matrix} \right]</script>
(Xä½œä¸º$F_n$,Yä½œä¸º$F_{n+1}$),å…¶ä¸‹ä¸€é¡¹å°†æ˜¯<script type="math/tex">\left[\begin{matrix} Y\\ X+Y \end{matrix}\right]</script></p>

<p>å†™æˆçŸ©é˜µä¹˜æ³•å³ä¹˜ä¸Š<script type="math/tex">% <![CDATA[
\left[\begin{matrix}0 & 1\\ 1 & 1 \end{matrix}\right] %]]></script></p>

<p>æ¥ä¸‹æ¥å°±æ˜¯æ±‚è¿™ä¸ªçŸ©é˜µçš„å¹‚äº†,æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªçŸ©é˜µçš„å¹‚æ“ä½œ,ç„¶ååˆ†è§£æŒ‡æ•°,å®Œæˆå¿«é€Ÿå¹‚</p>

<p><strong>æ¨¡å°±å…¨ç¨‹æ¨¡</strong> (ä¸ç„¶è¯¥æº¢å‡ºè¿˜æ˜¯æº¢å‡º)</p>

<div class="language-cpp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">#include&lt;iostream&gt;
#define MOD 1000000007
</span><span class="k">typedef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">ll</span><span class="p">;</span>
<span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>
<span class="k">struct</span> <span class="n">mat</span><span class="p">{</span>
    <span class="n">ll</span> <span class="n">x1</span><span class="p">,</span><span class="n">x2</span><span class="p">,</span><span class="n">x3</span><span class="p">,</span><span class="n">x4</span><span class="p">;</span>
    <span class="n">mat</span><span class="p">()</span><span class="o">=</span><span class="k">default</span><span class="p">;</span>
    <span class="n">mat</span><span class="p">(</span><span class="kt">int</span> <span class="n">a</span><span class="p">,</span><span class="kt">int</span> <span class="n">b</span><span class="p">,</span><span class="kt">int</span> <span class="n">c</span><span class="p">,</span><span class="kt">int</span> <span class="n">d</span><span class="p">){</span>
        <span class="n">x1</span><span class="o">=</span><span class="n">a</span><span class="p">;</span><span class="n">x2</span><span class="o">=</span><span class="n">b</span><span class="p">;</span><span class="n">x3</span><span class="o">=</span><span class="n">c</span><span class="p">;</span><span class="n">x4</span><span class="o">=</span><span class="n">d</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">mat</span> <span class="k">operator</span><span class="o">*</span> <span class="p">(</span><span class="k">const</span> <span class="n">mat</span> <span class="o">&amp;</span><span class="n">b</span><span class="p">){</span>
        <span class="n">mat</span> <span class="n">tmp</span><span class="p">;</span>
        <span class="n">tmp</span><span class="p">.</span><span class="n">x1</span><span class="o">=</span><span class="p">(</span><span class="n">x1</span><span class="o">*</span><span class="n">b</span><span class="p">.</span><span class="n">x1</span><span class="o">+</span><span class="n">x2</span><span class="o">*</span><span class="n">b</span><span class="p">.</span><span class="n">x3</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
        <span class="n">tmp</span><span class="p">.</span><span class="n">x2</span><span class="o">=</span><span class="p">(</span><span class="n">x1</span><span class="o">*</span><span class="n">b</span><span class="p">.</span><span class="n">x2</span><span class="o">+</span><span class="n">x2</span><span class="o">*</span><span class="n">b</span><span class="p">.</span><span class="n">x4</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
        <span class="n">tmp</span><span class="p">.</span><span class="n">x3</span><span class="o">=</span><span class="p">(</span><span class="n">x3</span><span class="o">*</span><span class="n">b</span><span class="p">.</span><span class="n">x1</span><span class="o">+</span><span class="n">x4</span><span class="o">*</span><span class="n">b</span><span class="p">.</span><span class="n">x3</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
        <span class="n">tmp</span><span class="p">.</span><span class="n">x4</span><span class="o">=</span><span class="p">(</span><span class="n">x3</span><span class="o">*</span><span class="n">b</span><span class="p">.</span><span class="n">x2</span><span class="o">+</span><span class="n">x4</span><span class="o">*</span><span class="n">b</span><span class="p">.</span><span class="n">x4</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="p">;</span>
        <span class="k">return</span> <span class="n">tmp</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">};</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(){</span>
    <span class="n">ll</span> <span class="n">n</span><span class="p">;</span><span class="n">cin</span><span class="o">&gt;&gt;</span><span class="n">n</span><span class="p">;</span><span class="n">n</span><span class="o">--</span><span class="p">;</span>
    <span class="n">mat</span> <span class="n">matrix</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
    <span class="n">mat</span> <span class="n">ans</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
    <span class="k">while</span><span class="p">(</span><span class="n">n</span><span class="p">){</span>
        <span class="k">if</span><span class="p">(</span><span class="n">n</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span><span class="n">ans</span><span class="o">=</span><span class="n">ans</span><span class="o">*</span><span class="n">matrix</span><span class="p">;</span>
        <span class="n">matrix</span> <span class="o">=</span> <span class="n">matrix</span> <span class="o">*</span> <span class="n">matrix</span><span class="p">;</span>
        <span class="n">n</span><span class="o">&gt;&gt;=</span><span class="mi">1</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="p">(</span><span class="n">ans</span><span class="p">.</span><span class="n">x1</span><span class="o">+</span><span class="n">ans</span><span class="p">.</span><span class="n">x2</span><span class="p">)</span><span class="o">%</span><span class="n">MOD</span><span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

</code></pre></div></div>

:ET